# openAI
Интеграция с openAI (создатели chatGPT)

## В цьому репозиторії розміщено 3 окремих скрипта для інтеграції з різними мовними моделями штучного інтелекту від openAI
1. OpenAI - перша версія штучного інтелекту (попередник chatGPT). [Інстукція](#openai-1)
2. ChatGPT - основна версія штучного інтелекту від openAI. [Інструкція](#chatgpt)
3. GPTassist - асистент на базі штучного інтелекту chatGPT з розширеними можливостями, включаючи можливість підключення файлової бази знань для персоналізації відповідей. [Інструкція](#gptassist)


## openAI

Инструкция:
1. Загрузить файл openAI.php на Ваш хостинг
2. Указать в файле токен Smart Sender и токен openAI (получить тут: https://platform.openai.com/account/api-keys )
3. В нужном месте воронки использовать блок "Действие - Внешний запрос" с типом POST и следующим телом запроса:
```
{
    "userId":"{{ userId }}",
    "request":"%text% Что делаеш?",
    "response":"Ответ за %time%.\n%result%"
}
```
где:

request - вопрос к openAI. При наличии в вопросе %text%, вместо него подставляется последнее сообщение пользователя

response - ответ пользователю. Обезательно должен содержать %result% вместо которого подставляется ответ от openAI. Вместо %time% подставляется время обработки в формате "15сек" (необезательно)

Поскольку, это самая первая языковая модель искуственного интелекта, его возможности ограничены. Каждый запрос к ИИ является независимым

## chatGPT

Обновленная языковая модель ИИ, которая уже работает по принципу чата. Это означает, что ИИ уже понимает контекст диалога на основании предыдущих обращений пользователя к ИИ и его ответов

Инструкция:
1. Загрузить файл chatGPT.php на Ваш хостинг
2. Указать в файле токен Smart Sender и токен openAI (получить тут: https://platform.openai.com/account/api-keys )
3. В нужном месте воронки использовать блок "Действие - Внешний запрос" с типом POST и следующим телом запроса:
```
{
    "userId":"{{ userId }}",
    "request":"%text% Что делаеш?",
    "response":"Ответ за %time%.\n%result%"
}
```
где:

request - вопрос к openAI. При наличии в вопросе %text%, вместо него подставляется последнее сообщение пользователя

response - ответ пользователю. Обезательно должен содержать %result% вместо которого подставляется ответ от openAI. Вместо %time% подставляется время обработки в формате "15сек" (необезательно)


Обратите внимание, что этот файл уже работает в формате чата и при каждом запросе будет передаватся вся история переписки пользователя с искуственным интелектом, что повлечет увеличение стоимости использования API. История разных пользователей не пересекается между собой. В целях оптимизации можно добавить в тело запроса параметр ```"clearChat":true```, что очистит историю диалога пользователя. Также для установки указаний для бота (чтобы он предоставлял ограниченные, персонификованые для Вашей компании ответы) можно использовать параметр ```promt``` (добавляется в новый/очищеный диалог)

## GPTassist

Інструкція:
1. Завантажити на Ваш хостинг файл gpts.php
2. Вказати в файлі токен SmartSender та токен openAI (отримати тут: https://platform.openai.com/api-keys )
3. В потрібному місці воронки, або в автовідповіді за замовчуванням використовувати блок "Дія" - "Зовнішній запит" з типом POST та наступним тілом запиту:
```
{
    "assistantId":"{{ assistId }}",
    "userId":"{{ userId }}"
}
```
Це мінімальний набір параметрів, необхідний для роботи скрипта. Але його можна також доповнювати, залежно від Ваших завдань. Підтримуванні параметри:
- assistantId - ідентифікатор асистента, створеного в кабінеті openAI
- userId - ідентифікатор користувача. Використовуйте змінну userId
- message - текст звернення до асистента. Якщо відсутнє, то використовується останє повідомлення користувача
- instructions - інструкції для асистента, які замінюють стандартну інструкцію, вказану в налаштуваннях асистента
- additional_instructions - інструкції для асистента, які доповнюють стандартну інструкцію, вказану в налаштуваннях асистента
- timeLimit - обмеження часу виконання в секундах. Якщо не вказано, то за замовчуванням 100сек
- failedMessage - текст відповіді, якщо відповідь не надана асистентом за відведений час. За замовчуванням "Нажаль, я не можу відповісти. Спробуйте пізніше, або перефразуйте Ваше повідомлення"
- answerMessage - формат відповіді від асистента. Наприклад "Відповідь: %answer%". Тоді відповідь асистента буде підставлена замість %answer% і це повідомлення буде відправлено користувачу. Якщо не вказано, то користувачу відправиться оригінальна відповідь асистента

## Загальна інформація

Так как ответ от openAI может поступать с задержкой, скрипт сам отправляет сообщение с ответом пользователю и соответствия для сохранения ответа не требуются. Этот формат работы также избегает проблем, связаных с ограничением длины переменной, которое обрезало бы длинные ответы
